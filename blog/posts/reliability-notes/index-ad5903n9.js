import{a as S,b as V,c as Y,d as G,e as T,f as K,g as q,h as z,i as N,j as U}from"../../chunks/index-rmmfhhcn.js";var I=S(V(),1),B=S(Y(),1);function J(A){let f={blockquote:"blockquote",code:"code",em:"em",h1:"h1",h2:"h2",h3:"h3",hr:"hr",li:"li",p:"p",pre:"pre",span:"span",strong:"strong",ul:"ul",...G(),...A.components};return z(N,{children:[q(f.h1,{children:"Reliability Notes: Designing for Failure"}),z(f.p,{children:["by ",q(f.strong,{children:"Ansh Tulsyan"})," · 20 Jan 2025 · AI Alignment Forum"]}),q("br",{}),q(f.p,{children:"Healthy systems assume the world is messy. This post collects the habits I reach for when latency spikes, retries pile up, and users keep clicking refresh."}),q(f.h2,{children:"Start with graceful degradation"}),z(f.p,{children:["The question isn't ",q(f.em,{children:"if"})," dependencies fail—it's how you behave when they do. Good fallbacks keep users moving while you fix the root cause."]}),z(f.ul,{children:[`
`,q(f.li,{children:"Tight timeouts on anything over the network"}),`
`,q(f.li,{children:"Circuit breakers that trip fast and recover slowly"}),`
`,q(f.li,{children:"Cached success paths to survive brief outages"}),`
`,q(f.li,{children:"Default responses that keep the UI stable"}),`
`]}),q(f.h2,{children:"Idempotency everywhere"}),q(f.p,{children:"At-least-once delivery means every mutation should be safe to repeat. Idempotency keys plus conditional writes get you most of the way there."}),q(K,{children:q(f.pre,{className:"shiki github-light",style:{backgroundColor:"#fff",color:"#24292e"},tabIndex:"0",children:z(f.code,{children:[z(f.span,{className:"line",children:[q(f.span,{style:{color:"#D73A49"},children:"async"}),q(f.span,{style:{color:"#D73A49"},children:" function"}),q(f.span,{style:{color:"#6F42C1"},children:" savePreferences"}),q(f.span,{style:{color:"#24292E"},children:"("}),q(f.span,{style:{color:"#E36209"},children:"userId"}),q(f.span,{style:{color:"#D73A49"},children:":"}),q(f.span,{style:{color:"#005CC5"},children:" string"}),q(f.span,{style:{color:"#24292E"},children:", "}),q(f.span,{style:{color:"#E36209"},children:"payload"}),q(f.span,{style:{color:"#D73A49"},children:":"}),q(f.span,{style:{color:"#6F42C1"},children:" Preferences"}),q(f.span,{style:{color:"#24292E"},children:") {"})]}),`
`,z(f.span,{className:"line",children:[q(f.span,{style:{color:"#D73A49"},children:"  const"}),q(f.span,{style:{color:"#005CC5"},children:" key"}),q(f.span,{style:{color:"#D73A49"},children:" ="}),q(f.span,{style:{color:"#032F62"},children:" `prefs:${"}),q(f.span,{style:{color:"#24292E"},children:"userId"}),q(f.span,{style:{color:"#032F62"},children:"}:${"}),q(f.span,{style:{color:"#24292E"},children:"payload"}),q(f.span,{style:{color:"#032F62"},children:"."}),q(f.span,{style:{color:"#24292E"},children:"version"}),q(f.span,{style:{color:"#032F62"},children:"}`"}),q(f.span,{style:{color:"#24292E"},children:";"})]}),`
`,z(f.span,{className:"line",children:[q(f.span,{style:{color:"#D73A49"},children:"  const"}),q(f.span,{style:{color:"#005CC5"},children:" alreadySeen"}),q(f.span,{style:{color:"#D73A49"},children:" ="}),q(f.span,{style:{color:"#D73A49"},children:" await"}),q(f.span,{style:{color:"#24292E"},children:" redis."}),q(f.span,{style:{color:"#6F42C1"},children:"get"}),q(f.span,{style:{color:"#24292E"},children:"(key);"})]}),`
`,z(f.span,{className:"line",children:[q(f.span,{style:{color:"#D73A49"},children:"  if"}),q(f.span,{style:{color:"#24292E"},children:" (alreadySeen) "}),q(f.span,{style:{color:"#D73A49"},children:"return"}),q(f.span,{style:{color:"#24292E"},children:";"})]}),`
`,q(f.span,{className:"line"}),`
`,z(f.span,{className:"line",children:[q(f.span,{style:{color:"#D73A49"},children:"  await"}),q(f.span,{style:{color:"#24292E"},children:" db.preferences."}),q(f.span,{style:{color:"#6F42C1"},children:"upsert"}),q(f.span,{style:{color:"#24292E"},children:"({ userId, "}),q(f.span,{style:{color:"#D73A49"},children:"..."}),q(f.span,{style:{color:"#24292E"},children:"payload });"})]}),`
`,z(f.span,{className:"line",children:[q(f.span,{style:{color:"#D73A49"},children:"  await"}),q(f.span,{style:{color:"#24292E"},children:" redis."}),q(f.span,{style:{color:"#6F42C1"},children:"set"}),q(f.span,{style:{color:"#24292E"},children:"(key, "}),q(f.span,{style:{color:"#032F62"},children:'"1"'}),q(f.span,{style:{color:"#24292E"},children:", { EX: "}),q(f.span,{style:{color:"#005CC5"},children:"60"}),q(f.span,{style:{color:"#D73A49"},children:" *"}),q(f.span,{style:{color:"#005CC5"},children:" 60"}),q(f.span,{style:{color:"#24292E"},children:" });"})]}),`
`,q(f.span,{className:"line",children:q(f.span,{style:{color:"#24292E"},children:"}"})})]})})}),q(f.h2,{children:"Observe before you guess"}),q(f.p,{children:"The fastest way to debug production is to never be surprised. Metrics, logs, and traces answer different questions—use all three."}),z(f.blockquote,{children:[`
`,q(f.p,{children:`"A distributed system is one in which the failure of a computer you didn't even know existed can render your own computer unusable." — Leslie Lamport`}),`
`]}),q(f.h3,{children:"What to watch"}),z(f.ul,{children:[`
`,z(f.li,{children:[q(f.strong,{children:"Latency distributions"}),", not averages"]}),`
`,z(f.li,{children:[q(f.strong,{children:"Error ratios"})," with fast alerts, noisy logs with slower rollups"]}),`
`,z(f.li,{children:[q(f.strong,{children:"Retry storms"})," that masquerade as traffic growth"]}),`
`]}),q(f.h2,{children:"Practice incident muscle memory"}),q(f.p,{children:"Run game days. Document playbooks. Make rollbacks boring. Reliability isn't a property you declare; it's a habit you rehearse."}),q(f.hr,{}),q(f.p,{children:"If this resonated, you might like the longform essay on distributed guarantees back on the main site."})]})}function H(A={}){let{wrapper:f}={...G(),...A.components};return f?q(f,{...A,children:q(J,{...A})}):J(A)}var O=I.default.createElement(T,{components:U},I.default.createElement(H)),Q=document.getElementById("mdx");if(window.__SCRATCH_SSG__)console.log("Hydrating mdx component"),B.hydrateRoot(Q,O);else console.log("Rendering mdx component"),B.createRoot(Q).render(O);
