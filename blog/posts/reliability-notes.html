<!doctype html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <link rel="stylesheet" href="/blog/tailwind-3515b092.css" />
    <link rel="icon" type="image/svg+xml" href="/blog/favicon.svg" />
    <script>window.__SCRATCH_BASE__ = "/blog"; window.__SCRATCH_SSG__ = true;</script>
      <title>Reliability Notes: Designing for Failure</title>
    <meta name="description" content="A LessWrong-inspired walkthrough on building resilient systems">
    <meta name="keywords" content="distributed systems, reliability, lesswrong, engineering notes">
    <meta name="author" content="Ansh Tulsyan">
    <meta property="og:title" content="Reliability Notes: Designing for Failure">
    <meta property="og:description" content="A LessWrong-inspired walkthrough on building resilient systems">
    <meta property="og:type" content="article">
    <meta name="twitter:title" content="Reliability Notes: Designing for Failure">
    <meta name="twitter:description" content="A LessWrong-inspired walkthrough on building resilient systems">
    <meta name="twitter:card" content="summary_large_image">
    <script>window.__scratch_author__ = "Ansh Tulsyan";</script>
  </head>
  <body>
    <div id="mdx"><link rel="preload" as="image" href="/blog/scratch-logo.svg"/><div class="min-h-screen bg-background text-body flex flex-col"><header class="fixed top-0 left-0 right-0 z-50 transition-all duration-300 bg-transparent translate-y-0"><div class="container mx-auto px-6 py-4"><nav class="flex items-center justify-between"><a href="/" class="font-display text-xl font-semibold text-heading hover:text-primary transition-colors">Ansh Tulsyan</a><div class="hidden md:flex items-center gap-6"><ul class="flex items-center gap-8"><li><a href="/#about" class="link-underline text-body font-medium hover:text-primary transition-colors">About</a></li><li><a href="/#experience" class="link-underline text-body font-medium hover:text-primary transition-colors">Experience</a></li><li><a href="/#projects" class="link-underline text-body font-medium hover:text-primary transition-colors">Projects</a></li><li><a href="/#writing" class="link-underline text-body font-medium hover:text-primary transition-colors">Writing</a></li><li><a href="/#contact" class="link-underline text-body font-medium hover:text-primary transition-colors">Contact</a></li></ul><a href="https://drive.google.com/file/d/12EcCO5aD0HHSCTZbVYdnpSdS7sDFpRQ8/view?usp=drive_link" class="inline-flex items-center gap-2 rounded-md bg-primary px-4 py-2 text-sm font-medium text-primary-foreground shadow-sm hover:bg-primary/90 transition-colors" target="_blank" rel="noopener noreferrer">Resume</a></div><button class="md:hidden p-2 text-body hover:text-primary transition-colors" aria-label="Toggle menu"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-menu"><line x1="4" x2="20" y1="12" y2="12"></line><line x1="4" x2="20" y1="6" y2="6"></line><line x1="4" x2="20" y1="18" y2="18"></line></svg></button></nav></div></header><main class="flex-1"><div class="mx-auto max-w-[1180px] px-6 pt-28 pb-16 xl:grid xl:grid-cols-[220px_minmax(0,1fr)] xl:gap-10 xl:items-start flex flex-col gap-10 overflow-visible"><div class="hidden xl:block -ml-6 xl:sticky xl:top-5"><aside class="w-[210px] lw-toc pr-4"><div class="relative pl-6 text-subtle"><div class="absolute left-1 top-0 bottom-0 w-px bg-border"></div><div class="flex items-center gap-2 mb-3 text-[0.68rem] uppercase tracking-[0.18em] text-heading"><span>Contents</span></div><nav class="space-y-2"><a class="group relative block pl-4 transition-colors  hover:text-heading pointer-events-none text-subtle"><span class="absolute left-[-0.75rem] top-1 h-2 w-2 rounded-full border border-border bg-background transition-transform "></span>Loading…</a></nav></div></aside></div><article class="lw-content max-w-3xl flex-1 prose prose-lg prose-headings:text-heading prose-headings:font-semibold prose-a:text-primary prose-a:underline prose-a:underline-offset-4 prose-a:transition-colors prose-blockquote:border-primary prose-blockquote:bg-accent/30 prose-blockquote:italic"><h1>Reliability Notes: Designing for Failure</h1><p>by <strong>Ansh Tulsyan</strong> · 20 Jan 2025 · AI Alignment Forum</p><br/><p>Healthy systems assume the world is messy. This post collects the habits I reach for when latency spikes, retries pile up, and users keep clicking refresh.</p><h2 id="start-with-graceful-degradation" class="group relative"><a href="#start-with-graceful-degradation" class="heading-anchor" aria-label="Link to Start with graceful degradation"></a>Start with graceful degradation</h2><p>The question isn&#x27;t <em>if</em> dependencies fail—it&#x27;s how you behave when they do. Good fallbacks keep users moving while you fix the root cause.</p><ul>
<li>Tight timeouts on anything over the network</li>
<li>Circuit breakers that trip fast and recover slowly</li>
<li>Cached success paths to survive brief outages</li>
<li>Default responses that keep the UI stable</li>
</ul><h2 id="idempotency-everywhere" class="group relative"><a href="#idempotency-everywhere" class="heading-anchor" aria-label="Link to Idempotency everywhere"></a>Idempotency everywhere</h2><p>At-least-once delivery means every mutation should be safe to repeat. Idempotency keys plus conditional writes get you most of the way there.</p><div class="relative group"><button class="copy-button" aria-label="Copy code">Copy</button><pre class="shiki github-light" style="background-color:#fff;color:#24292e" tabindex="0"><code><span class="line"><span style="color:#D73A49">async</span><span style="color:#D73A49"> function</span><span style="color:#6F42C1"> savePreferences</span><span style="color:#24292E">(</span><span style="color:#E36209">userId</span><span style="color:#D73A49">:</span><span style="color:#005CC5"> string</span><span style="color:#24292E">, </span><span style="color:#E36209">payload</span><span style="color:#D73A49">:</span><span style="color:#6F42C1"> Preferences</span><span style="color:#24292E">) {</span></span>
<span class="line"><span style="color:#D73A49">  const</span><span style="color:#005CC5"> key</span><span style="color:#D73A49"> =</span><span style="color:#032F62"> `prefs:${</span><span style="color:#24292E">userId</span><span style="color:#032F62">}:${</span><span style="color:#24292E">payload</span><span style="color:#032F62">.</span><span style="color:#24292E">version</span><span style="color:#032F62">}`</span><span style="color:#24292E">;</span></span>
<span class="line"><span style="color:#D73A49">  const</span><span style="color:#005CC5"> alreadySeen</span><span style="color:#D73A49"> =</span><span style="color:#D73A49"> await</span><span style="color:#24292E"> redis.</span><span style="color:#6F42C1">get</span><span style="color:#24292E">(key);</span></span>
<span class="line"><span style="color:#D73A49">  if</span><span style="color:#24292E"> (alreadySeen) </span><span style="color:#D73A49">return</span><span style="color:#24292E">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#D73A49">  await</span><span style="color:#24292E"> db.preferences.</span><span style="color:#6F42C1">upsert</span><span style="color:#24292E">({ userId, </span><span style="color:#D73A49">...</span><span style="color:#24292E">payload });</span></span>
<span class="line"><span style="color:#D73A49">  await</span><span style="color:#24292E"> redis.</span><span style="color:#6F42C1">set</span><span style="color:#24292E">(key, </span><span style="color:#032F62">&quot;1&quot;</span><span style="color:#24292E">, { EX: </span><span style="color:#005CC5">60</span><span style="color:#D73A49"> *</span><span style="color:#005CC5"> 60</span><span style="color:#24292E"> });</span></span>
<span class="line"><span style="color:#24292E">}</span></span></code></pre></div><h2 id="observe-before-you-guess" class="group relative"><a href="#observe-before-you-guess" class="heading-anchor" aria-label="Link to Observe before you guess"></a>Observe before you guess</h2><p>The fastest way to debug production is to never be surprised. Metrics, logs, and traces answer different questions—use all three.</p><blockquote>
<p>&quot;A distributed system is one in which the failure of a computer you didn&#x27;t even know existed can render your own computer unusable.&quot; — Leslie Lamport</p>
</blockquote><h3 id="what-to-watch" class="group relative"><a href="#what-to-watch" class="heading-anchor" aria-label="Link to What to watch"></a>What to watch</h3><ul>
<li><strong>Latency distributions</strong>, not averages</li>
<li><strong>Error ratios</strong> with fast alerts, noisy logs with slower rollups</li>
<li><strong>Retry storms</strong> that masquerade as traffic growth</li>
</ul><h2 id="practice-incident-muscle-memory" class="group relative"><a href="#practice-incident-muscle-memory" class="heading-anchor" aria-label="Link to Practice incident muscle memory"></a>Practice incident muscle memory</h2><p>Run game days. Document playbooks. Make rollbacks boring. Reliability isn&#x27;t a property you declare; it&#x27;s a habit you rehearse.</p><hr/><p>If this resonated, you might like the longform essay on distributed guarantees back on the main site.</p></article></div></main><footer class="flex flex-col items-center gap-1 py-8"><a href="https://scratch.dev" target="_blank" rel="noopener noreferrer" class="inline-flex items-center text-gray-400 text-sm font-normal no-underline hover:no-underline"><span class="text-sm">Made from</span><img src="/blog/scratch-logo.svg" alt="Scratch" class="h-9 pb-0.5"/></a></footer></div></div>
    <script type="module" src="/blog/posts/reliability-notes/index-ad5903n9.js"></script>
  </body>
</html>